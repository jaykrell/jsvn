<html><head><script><!-- hide//// Jay Krell// jay.krell@cornell.edu// October 2003//// after reading the eye opening// http://www.mactech.com/articles/mactech/Vol.16/16.06/SolitaireinJavaScript/index.html// http://stowlake.com/Solitaire//// and having written Tetris in Applesoft Basic over ten years ago,// before I knew these Rotations had something to do with the sine and// cosine of 0, 90, 180, 270.//var Width = 30;var Height = 20;var Pieces =[[ // line  // ....[-1,0],[0,0],[1,0],[2,0]],[ // square  // ..  // ..  [0,0],[1,0],  [0,1],[1,1]],[ // zigzag  // ..  //  .. [-1,0],[0,0],        [0,1],[1,1]],[ // reverse zigzag  //  ..  // ..        [0,0],[1,0], [1,1],[0,1]],[ // tee  //  .  // ...       [0,-1],[-1,0],[0,0],[1,0]],[ // hook  //   .  // ...             [1,-1],[-1,0],[0,0],[1,0]],[ // reverse hook  // .  // ...[-1,-1],[-1,0],[0,0],[1,0]],];var Rotations =[// 0[[1,0],[0,1]],// 90[[0,-1],[1,0]],// 180[[-1,0],[0,-1]],// 270[[0,1],[-1,0]]];for (var i = 0 ; i != Pieces.length ; ++i){	Pieces[i].NumberOfRotations = Rotations.length;}Pieces[0].NumberOfRotations = 2; // linePieces[1].NumberOfRotations = 1; // squarevar StateBorder = 1;var StateCurrentPiece = 2;var StateOldPiece = 3;var StateEmpty = 4;function Write(s) { document.write(s); }function Writeln(s) { document.writeln(s); }function MakeBoard(){var x, y, Cell, b = new Array();for ( x = 0 ; x != Width ; ++x){  b[x] = new Array();  for (y = 0 ; y != Height ; ++y)  {    Cell = new Object();    b[x][y] = Cell;    Cell.Border = false;    Cell.Color = 1;    Cell.State = StateEmpty;  }}for (x = 0 ; x != Width ; ++x){	Cell = b[x][Height - 1];    Cell.Border = true;    Cell.Color = 0;    Cell.State = StateBorder;}for (y = 0 ; y != Height ; ++y){    Cell = b[0][y];    Cell.Color = 0;    Cell.Border = true;    Cell.State = StateBorder;    Cell = b[Width - 1][y];    Cell.Border = true;    Cell.Color = 0;    Cell.State = StateBorder;}return b;}var Colors =['black','white','green','silver','lime','gray','olive','yellow','maroon','navy','red','blue','purple','teal','fuchsia','aqua'];function GetCell(x, y){	return document.getElementById('id' + x + '_' + y);}function SetColor(x, y, c){	GetCell(x, y).setAttribute('bgColor', c);}function OnMouseOver(x, y) { SetColor(x, y, 'black'); }function OnMouseDown(x, y){	SetColor(x, y, 'red');}function OnMouseUp(x, y) { SetColor(x, y, 'green'); }function DrawScreen(b){	Write('<table name=t Width=100% Height=100%'	+ ' cellPadding=0'	+ ' cellSpacing=0'	//+ ' frame=0 Border=0'	//+ ' onkeypress="OnKeyPress()"'	+ ' >');	for (var y = 0 ; y != Height ; ++y)	{	  Writeln('<tr>');	  for (var x = 0 ; x != Width ; ++x)	  {		var xy = x + "," + y;		Write(''	 + '<td'	 + ' id=id' + x + '_' + y	 + ' bgColor=' + Colors[b[x][y].Color]	 + ' onMouseOver="self.status=' + "''" + '; OnMouseOver(' + xy + ');"'	 + ' onMouseDown="self.status=' + "''" + '; OnMouseDown(' + xy + ');"'	 + ' onMouseUp="self.status=' + "''" + '; OnMouseUp(' + xy + ');"'	 + ' </td>'		);	  }	  Writeln('</tr>');	}	Write('</table>');	var d = document;	for (var x = 0 ; x != Width ; ++x)	{		var id = 'id' + x + '_';		for (var y = 0 ; y != Height ; ++y)	 	{			b[x][y].e = d.getElementById(id + y);		}	}	var Color = Colors[Piece + 2];	var x = PieceCenter[0];	var y = PieceCenter[1];	var Offsets = Pieces[Piece];	var r = Rotations[PieceRotation];	var r00 = r[0][0];	var r01 = r[0][1];	var r10 = r[1][0];	var r11 = r[1][1];	for (var i = 0; i != Offsets.length; ++i)	{		var Offset = Offsets[i];		e = d.getElementById(			"id"			+ (x + Offset[0] * r00 + Offset[1] * r10)			+ '_'			+ (y + Offset[0] * r01 + Offset[1] * r11))		e.setAttribute('bgColor', Color);	}}var PieceCenter = [2, 2];var Piece = 0;var PieceRotation = 0;var Paused = 0;function Tick(){	if (Paused)	{		return;	}	if ((PieceCenter[1] += 1) == (Height - 2))	{		if ((Piece += 1) == Pieces.length)		{			Piece = 0;			PieceRotation = 0;		}		PieceCenter[1] = 1;	}}function CharCode(s) { return s.charCodeAt(0); }var CharCode_Space = CharCode(' ');var CharCode_j = CharCode('j');var CharCode_J = CharCode('J');var CharCode_k = CharCode('k');var CharCode_K = CharCode('K');var CharCode_l = CharCode('l');var CharCode_L = CharCode('L');function TogglePause(){	Paused = !Paused;}function DropPieceNow(){	PieceCenter[1] = Height - 3;}function RotatePiece(){	PieceRotation = ((PieceRotation + 1) % Pieces[Piece].NumberOfRotations);}function ComputePiecePoints(Piece, Center){	var cx = Center[0];	var cy = Center[1];	var o = Pieces[Piece];	var r = Rotations[PieceRotation];	var r00 = r[0][0];	var r01 = r[0][1];	var r10 = r[1][0];	var r11 = r[1][1];	var Points = [ ];	for (var i = 0; i != Offsets.length; ++i)	{		var oi = o[i];		var x = cx + oi[0] * r00 + oi[1] * r10;		var y = cy + oi[0] * r01 + oi[1] * r11;				if (Points[x] == undefined)		{		    Points[x] = [ ];		}		Points[x][y] = 1;	}	return Points;}function UpdatePiece(PreviousCenter, Center){	var PreviousPoints =  ComputePiecePoints(Piece, PreviousCenter);	var Points =  ComputePiecePoints(Piece, Center);	var x;	var y;	for (x = 0 ; x != PreviousPoints.length ; ++x)	{	  for (y = 0 ; y != PreviousPoints[x].length ; ++y)	  {	  	if (	  }	}}function MovePieceRight(){	if (PieceCenter[0] == (Width - 1))		return;	var Previous = PieceCenter;	PieceCenter[0] += 1;	UpdatePiece(PreviousPieceCenter, PieceCenter);}function MovePieceLeft(){	if (PieceCenter[0] == 1)		return;	var Previous = PieceCenter;	PieceCenter[0] -= 1;	UpdatePiece(PreviousPieceCenter, PieceCenter);}function OnKeyPress(event){	//document.getElementById('id1_1').innerText = 'abc';	//alert(event.keyCode + event.charCode);	switch (event.keyCode + event.charCode)	{		case 27: // escape			TogglePause();			break;	}		if (Paused)		return;	switch (event.keyCode + event.charCode)	{		case 32: // space			DropPieceNow();			break;				case CharCode_k:		case CharCode_K:			RotatePiece();			break;		case 37: // left arrow		case CharCode_j:		case CharCode_J:			MovePieceLeft();			break;		case 39:		case CharCode_l:		case CharCode_L:			MovePieceRight();			break;	}		}var Board = MakeBoard();var b = Board;// nohide--></script></head><script><!--hidewindow.onkeypress = OnKeyPress;DrawScreen(b);window.setInterval("Tick()", 1000);// nohide--></script></html>